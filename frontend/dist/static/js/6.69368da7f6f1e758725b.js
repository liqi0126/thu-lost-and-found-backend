webpackJsonp([6],{WMvj:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("mtWM"),i=a.n(l),n={components:{"search-filter":a("KI//").a},props:{id:Number,pageSize:Number,height:Number},data:function(){return{dialogFormVisible:!1,image_visible:!1,property_template_list:[],property_type_list:[],image:null,image_url:"",options:[{value:"search",label:"全部搜索"},{value:"creator",label:"筛选：申请者"}],select:"search",input:"",template:{name:"",type:"",thumbnail:null,thumbnail_url:"",fields:""},data:{count:0}}},created:function(){var t=this;i.a.get("/property-templates",{}).then(function(e){t.property_template_list=e.data,console.log(t.property_template_list.results)}).catch(function(t){alert("error:"+t)}),i.a.get("/property-types",{}).then(function(e){t.property_type_list=e.data}).catch(function(t){alert("error:"+t)}),this.changePage(1)},methods:{handleEdit:function(t,e){console.log(t,e)},handleDelete:function(t,e){var a=this;i.a.delete("/property-templates/"+e.id+"/",{}).then(function(t){a.reload()}).catch(function(t){alert("error:"+t)})},handleImageUploadSuccess:function(t){this.template.thumbnail_url=t.url,this.image_visible=!0},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},checkType:function(t,e){this.template.thumbnail=t},reload:function(){location.reload()},CreateNewTemplate:function(){var t=this,e=new FormData;e.append("name",this.template.name),e.append("type",this.template.type),e.append("thumbnail",this.template.thumbnail.raw),e.append("fields",this.template.fields),i()({url:"/property-templates/",method:"post",data:e}).then(function(e){t.dialogFormVisible=!1,t.reload(),console.log(e.data)}).catch(function(t){alert("error:"+t)}),this.dialogFormVisible=!1},enter:function(t){this.$router.push({name:"property-templates",params:{templateId:t.id}})},searchAndFilter:function(t,e){this.select=t,this.input=e,this.changePage(1)},changePage:function(t){}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"title-card"},[t._v("\n    所有物品模板\n    "),a("div",{staticClass:"edit"},[a("el-button",{staticClass:"change",attrs:{id:t.id,target:"rent-application",type:"primary"},on:{click:function(e){t.dialogFormVisible=!0}}},[t._v("新建")]),t._v(" "),a("el-button",{staticClass:"delete",attrs:{id:t.id,type:"primary",target:"rent-application"}},[t._v("删除")])],1)]),t._v(" "),a("el-dialog",{staticClass:"new_type",attrs:{title:"新建物品种类",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"物品模板名称"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.template.name,callback:function(e){t.$set(t.template,"name",e)},expression:"template.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"label",attrs:{label:"物品种类"}},[a("el-select",{model:{value:t.template.type,callback:function(e){t.$set(t.template,"type",e)},expression:"template.type"}},t._l(t.property_type_list.results,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"模板图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"none","on-preview":t.handleImageUploadSuccess,"list-type":"picture-card","auto-upload":!1,"on-change":t.checkType,limit:1,"on-exceed":t.handleExceed}},[t.image_visible?t._e():a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("el-dialog",{attrs:{visible:t.image_visible},on:{"update:visible":function(e){t.image_visible=e}}},[a("img",{attrs:{width:"100%",src:t.template.thumbnail_url,alt:""}})])],1),t._v(" "),a("el-form-item",{staticClass:"label",attrs:{label:"模板fields"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.template.fields,callback:function(e){t.$set(t.template,"fields",e)},expression:"template.fields"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"foot"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.CreateNewTemplate}},[t._v("确 定")])],1)])],1),t._v(" "),a("search-filter",{attrs:{options:t.options},on:{search:t.searchAndFilter}}),t._v(" "),a("el-card",{staticClass:"table-card"},[a("el-table",{staticClass:"table",attrs:{data:t.property_template_list.results,stripe:"",id:"users-table",height:t.height},on:{"row-click":t.enter}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"种类名称",width:"1000"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},nativeOn:{click:function(a){return a.stopPropagation(),t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(a){return a.stopPropagation(),t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{staticClass:"page-chooser",attrs:{background:"",layout:"prev, pager, next",total:10*t.data.count/t.pageSize},on:{"current-change":t.changePage}})],1)],1)},staticRenderFns:[]};var s={components:{"property-templates-table":a("VU/8")(n,r,!1,function(t){a("uO0D")},"data-v-75c5fb79",null).exports},methods:{},created:function(){"true"!=this.$store.getters.getUserLoginStatus&&this.$router.push("/login")}},o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("property-templates-table",{staticClass:"table",attrs:{id:-1,height:700,pageSize:10}})],1)},staticRenderFns:[]};var c=a("VU/8")(s,o,!1,function(t){a("uAoh")},"data-v-6880e2d4",null);e.default=c.exports},uAoh:function(t,e){},uO0D:function(t,e){}});
//# sourceMappingURL=6.69368da7f6f1e758725b.js.map
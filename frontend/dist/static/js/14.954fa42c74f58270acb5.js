webpackJsonp([14],{QIa6:function(e,t){},dvzB:function(e,t){},"f+x9":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("mvHQ"),l=i.n(a),s=i("mtWM"),n=i.n(s),o={components:{"search-filter":i("KI//").a},props:{id:Number,pageSize:Number,height:Number},data:function(){return{type_dialogFormVisible:!1,type_edit_dialogFormVisible:!1,template_dialogFormVisible:!1,image_visible:!1,type_edit_id:-1,property_template_list:[],property_type_list:[],options:[{value:"search",label:"全部搜索"},{value:"name",label:"筛选：名称"}],select:"search",input:"",type_name:{name:""},template:{name:"",type:"",thumbnail:null,thumbnail_url:"",fields:""},template_fields:[],inputVisible:!1,inputValue:"",data:{count:0},create_field_dialogFormVisible:!1,edit_field_dialogFormVisible:!1,edit_field_id:-1,field_show:[],edit_field:{name:"",details:""},create_field:{name:"",details:""},types_sum:0,pages_sum:0,pagination_update:!0}},created:function(){var e=this;n.a.get("/property-types",{}).then(function(t){e.property_type_list=t.data,e.types_sum=t.data.count,e.pagination_update=!1,e.$nextTick(function(){e.pagination_update=!0})}).catch(function(e){alert("error:"+e)})},methods:{createField:function(){var e=JSON.parse(l()(this.create_field));this.template_fields.push(e),this.create_field.name="",this.create_field.details="",this.create_field_dialogFormVisible=!1},editField:function(){var e=JSON.parse(l()(this.edit_field));this.$set(this.template_fields,this.edit_field_id,e),this.edit_field.name="",this.edit_field.details="",this.edit_field_dialogFormVisible=!1},handleFieldEdit:function(e,t){this.edit_field_dialogFormVisible=!0,this.edit_field_id=e},handleFieldCreate:function(e,t){this.create_field_dialogFormVisible=!0},handleFieldDelete:function(e,t){this.template_fields.splice(e,1)},handleClose:function(e){this.template_fields.splice(this.template_fields.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this.inputValue;e&&this.template_fields.push({name:e}),this.inputVisible=!1,this.inputValue=""},sortChange:function(e,t,i){var a=this,l=void 0;l="descending"==e.order?"-"+e.prop:e.prop,n.a.get("/property-types/",{params:{ordering:l}}).then(function(e){a.property_type_list=e.data}).catch(function(e){a.$alert(e.response.data)})},handleEdit:function(e,t){this.type_edit_dialogFormVisible=!0,this.type_edit_id=t.id},EditType:function(){var e=this,t={name:this.type_name.name};n()({url:"/property-types/"+this.type_edit_id+"/",method:"put",data:t,headers:{Authorization:"Bearer "+this.$store.getters.getUserAccessToken}}).then(function(t){e.type_edit_dialogFormVisible=!1,e.reload()}).catch(function(e){alert("error:"+e)}),this.type_edit_dialogFormVisible=!1},handleDelete:function(e,t){t.type?this.DeleteTemplateConfirm(t.id):this.DeleteTypeConfirm(t.id)},DeleteTypeConfirm:function(e){var t=this;return this.$confirm("此操作将删除该物品种类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.DeleteType(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})}),!1},DeleteType:function(e){var t=this;n.a.delete("/property-types/"+e+"/",{headers:{Authorization:"Bearer "+this.$store.getters.getUserAccessToken}}).then(function(e){t.reload()}).catch(function(e){alert("error:"+e)}),this.$message({type:"success",message:"删除成功!"})},DeleteTemplateConfirm:function(e){var t=this;return this.$confirm("此操作将删除该物品模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.DeleteTemplate(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})}),!1},DeleteTemplate:function(e){var t=this;n.a.delete("/property-templates/"+e+"/",{headers:{Authorization:"Bearer "+this.$store.getters.getUserAccessToken}}).then(function(e){t.reload()}).catch(function(e){alert("error:"+e)}),this.$message({type:"success",message:"删除成功!"})},handleImageUploadSuccess:function(e){this.template.thumbnail_url=e.url,this.image_visible=!0},handleExceed:function(e,t){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},checkType:function(e,t){this.template.thumbnail=e},reload:function(){location.reload()},CreateNewType:function(){var e=this,t={name:this.type_name.name};n()({url:"/property-types/",method:"post",data:t,headers:{Authorization:"Bearer "+this.$store.getters.getUserAccessToken}}).then(function(t){e.type_dialogFormVisible=!1,e.reload()}).catch(function(e){alert("error:"+e)}),this.type_dialogFormVisible=!1},CreateNewTemplate:function(){for(var e=this,t={},i=0;i<this.template_fields.length;i++)t[this.template_fields[i].name]=this.template_fields[i].details;this.template.fields=l()(t);var a=new FormData;a.append("name",this.template.name),a.append("type",this.template.type),a.append("thumbnail",this.template.thumbnail.raw),a.append("fields",this.template.fields),n()({url:"/property-templates/",method:"post",data:a,headers:{Authorization:"Bearer "+this.$store.getters.getUserAccessToken}}).then(function(t){e.template_dialogFormVisible=!1,e.reload()}).catch(function(e){alert("error:"+e)}),this.template_dialogFormVisible=!1},enter:function(e){e.type&&this.$router.push({name:"property-templates",params:{templateId:e.id}})},searchAndFilter:function(e,t){this.select=e,this.input=t,this.changePage(1)},changePage:function(e){var t=this;n.a.get("/property-types",{params:{page:e}}).then(function(e){t.property_type_list=e.data}).catch(function(e){t.$alert(e.response.data)})}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-card",{staticClass:"title-card"},[e._v("\n    所有物品\n    "),i("div",{staticClass:"edit"},[i("el-button",{staticClass:"change",attrs:{id:e.id,target:"rent-application",type:"primary"},on:{click:function(t){e.type_dialogFormVisible=!0}}},[e._v("新建物品种类")]),e._v(" "),i("el-button",{staticClass:"change",attrs:{id:e.id,target:"rent-application",type:"primary"},on:{click:function(t){e.template_dialogFormVisible=!0}}},[e._v("新建物品模板")])],1)]),e._v(" "),i("el-dialog",{staticClass:"create_contact",attrs:{title:"添加属性",visible:e.create_field_dialogFormVisible},on:{"update:visible":function(t){e.create_field_dialogFormVisible=t}}},[i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"属性名称"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.create_field.name,callback:function(t){e.$set(e.create_field,"name",t)},expression:"create_field.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"属性权重"}},[i("el-input-number",{attrs:{"controls-position":"right",min:1,max:10,size:"mini",width:"60%"},model:{value:e.create_field.details,callback:function(t){e.$set(e.create_field,"details",t)},expression:"create_field.details"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"foot"},[i("el-button",{on:{click:function(t){e.create_field_dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.createField}},[e._v("确 定")])],1)])],1),e._v(" "),i("el-dialog",{staticClass:"edit_contact",attrs:{title:"修改属性",visible:e.edit_field_dialogFormVisible},on:{"update:visible":function(t){e.edit_field_dialogFormVisible=t}}},[i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"属性名称"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.edit_field.name,callback:function(t){e.$set(e.edit_field,"name",t)},expression:"edit_field.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"属性名称"}},[i("el-input-number",{attrs:{"controls-position":"right",min:1,max:10,size:"mini",width:"60%"},model:{value:e.edit_field.details,callback:function(t){e.$set(e.edit_field,"details",t)},expression:"edit_field.details"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"foot"},[i("el-button",{on:{click:function(t){e.edit_field_dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.editField}},[e._v("确 定")])],1)])],1),e._v(" "),i("el-dialog",{staticClass:"new_type",attrs:{title:"新建物品种类",visible:e.type_dialogFormVisible},on:{"update:visible":function(t){e.type_dialogFormVisible=t}}},[i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"物品种类名称"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.type_name.name,callback:function(t){e.$set(e.type_name,"name",t)},expression:"type_name.name"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"foot"},[i("el-button",{on:{click:function(t){e.type_dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.CreateNewType}},[e._v("确 定")])],1)])],1),e._v(" "),i("el-dialog",{staticClass:"edit_type",attrs:{title:"修改物品种类",visible:e.type_edit_dialogFormVisible},on:{"update:visible":function(t){e.type_edit_dialogFormVisible=t}}},[i("el-form",{attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"物品种类名称"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.type_name.name,callback:function(t){e.$set(e.type_name,"name",t)},expression:"type_name.name"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"foot"},[i("el-button",{on:{click:function(t){e.type_dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.EditType}},[e._v("确 定")])],1)])],1),e._v(" "),i("el-dialog",{staticClass:"new_type",attrs:{title:"新建物品模板",visible:e.template_dialogFormVisible},on:{"update:visible":function(t){e.template_dialogFormVisible=t}}},[i("el-form",{attrs:{"label-width":"100px"}},[i("el-divider",[e._v("基本信息")]),e._v(" "),i("el-form-item",{attrs:{label:"物品模板名称"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.template.name,callback:function(t){e.$set(e.template,"name",t)},expression:"template.name"}})],1),e._v(" "),i("el-form-item",{staticClass:"label",attrs:{label:"物品种类"}},[i("el-select",{model:{value:e.template.type,callback:function(t){e.$set(e.template,"type",t)},expression:"template.type"}},e._l(e.property_type_list.results,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"模板图片"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"none","on-preview":e.handleImageUploadSuccess,"list-type":"picture-card","auto-upload":!1,"on-change":e.checkType,limit:1,"on-exceed":e.handleExceed}},[e.image_visible?e._e():i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{attrs:{visible:e.image_visible},on:{"update:visible":function(t){e.image_visible=t}}},[i("img",{attrs:{width:"100%",src:e.template.thumbnail_url,alt:""}})])],1),e._v(" "),i("el-divider",[e._v("模板属性")]),e._v(" "),i("el-form-item",{staticClass:"label",attrs:{label:"","label-width":"40px"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.template_fields}},[i("el-table-column",{attrs:{prop:"name",label:"名称",width:"330"}}),e._v(" "),i("el-table-column",{attrs:{prop:"details",label:"权重",width:"330"}}),e._v(" "),i("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(t){return[e._v("\n              操作\n              "),i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(i){return e.handleFieldCreate(t.$index,t.row)}}})]}},{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.handleFieldEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleFieldDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"foot"},[i("el-button",{on:{click:function(t){e.template_dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.CreateNewTemplate}},[e._v("确 定")])],1)])],1),e._v(" "),i("search-filter",{attrs:{options:e.options},on:{search:e.searchAndFilter}}),e._v(" "),i("el-card",{staticClass:"table-card"},[i("el-table",{staticClass:"table",attrs:{data:e.property_type_list.results,id:"users-table","row-key":"name","tree-props":{children:"templates"}},on:{"row-click":e.enter,"sort-change":e.sortChange}},[i("el-table-column",{attrs:{prop:"id",sortable:"custom",label:"ID",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",sortable:"custom",label:"名称",width:"1000"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"danger"},nativeOn:{click:function(i){return i.stopPropagation(),e.handleDelete(t.$index,t.row)}}},[e._v("删除")]),e._v(" "),t.row.type?e._e():i("el-button",{attrs:{size:"mini"},nativeOn:{click:function(i){return i.stopPropagation(),e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),e.pagination_update?i("el-pagination",{staticClass:"page-chooser",attrs:{background:"",layout:"prev, pager, next",total:e.types_sum},on:{"current-change":e.changePage}}):e._e()],1)],1)},staticRenderFns:[]};var d={components:{"property-types-table":i("VU/8")(o,r,!1,function(e){i("QIa6")},"data-v-4e23e0d9",null).exports},methods:{},created:function(){"true"!=this.$store.getters.getUserLoginStatus&&this.$router.push("/login")}},c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("property-types-table",{staticClass:"table",attrs:{id:-1,height:700,pageSize:10}})],1)},staticRenderFns:[]};var p=i("VU/8")(d,c,!1,function(e){i("dvzB")},"data-v-0068ca14",null);t.default=p.exports}});
//# sourceMappingURL=14.954fa42c74f58270acb5.js.map